<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Workspace Hub - British Sugar</title>

  <style>
    :root{
      --bg: #f8f9fa;
      --card: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --border: #e5e7eb;
      --shadow: 0 10px 30px rgba(0,0,0,0.06);
      --shadow-sm: 0 6px 18px rgba(0,0,0,0.06);
      --radius: 18px;
      --green: #8BC53F;
      --green-dark: #6AA61D;
      --danger: #ef4444;
      --warn: #f59e0b;
      --blue: #3b82f6;
      --focus: 0 0 0 4px rgba(139,197,63,0.25);
    }

    *{ box-sizing:border-box; margin:0; padding:0; -webkit-font-smoothing: antialiased; }
    body{
      min-height:100vh;
      background: var(--bg);
      color: var(--text);
      font-family: "Segoe UI", system-ui, -apple-system, Arial, sans-serif;
    }

    /* Top bar */
    .top-bar{
      position: sticky;
      top: 0;
      z-index: 50;
      background: var(--card);
      border-bottom: 3px solid var(--green);
      box-shadow: 0 2px 10px rgba(0,0,0,0.04);
      padding: 14px 22px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 16px;
    }

    .logo-area{
      display:flex;
      align-items:center;
      gap: 12px;
      min-width: 240px;
    }

    .logo-area img{
      height: 44px;
      width:auto;
      object-fit:contain;
      border-radius: 10px;
    }

    .logo-text{
      display:flex;
      flex-direction:column;
      line-height: 1.05;
    }

    .logo-text .main{
      font-weight: 700;
      letter-spacing: -0.4px;
      font-size: 16px;
    }

    .logo-text .sub{
      margin-top: 3px;
      font-size: 12px;
      color: var(--muted);
      font-weight: 600;
    }

    .export-btn{
      border: 1px solid var(--border);
      background: #fff;
      color: var(--text);
      font-weight: 700;
      font-size: 13px;
      padding: 10px 14px;
      border-radius: 12px;
      display:flex;
      align-items:center;
      gap:10px;
      cursor:pointer;
      box-shadow: 0 2px 10px rgba(0,0,0,0.03);
      transition: transform .08s ease, box-shadow .15s ease, border-color .15s ease;
      white-space: nowrap;
    }
    .export-btn:hover{
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
      border-color: rgba(139,197,63,0.45);
    }
    .export-btn:active{ transform: translateY(0); }
    .export-btn svg{ opacity: .85; }

    /* Layout */
    .container{
      max-width: 1100px;
      margin: 0 auto;
      padding: 22px 18px 60px;
    }

    .page-header{
      margin-top: 10px;
      margin-bottom: 14px;
      background: linear-gradient(135deg, rgba(139,197,63,0.20), rgba(255,255,255,0));
      border: 1px solid rgba(139,197,63,0.22);
      border-radius: var(--radius);
      padding: 18px 18px;
      box-shadow: 0 10px 24px rgba(0,0,0,0.03);
    }
    .page-header h1{
      font-size: 22px;
      letter-spacing: -0.5px;
      margin-bottom: 5px;
    }
    .page-header p{
      color: var(--muted);
      font-size: 13px;
      font-weight: 600;
    }

    /* Search */
    .search-wrap{
      margin: 14px 0 18px;
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 12px 14px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.04);
    }
    .search-wrap svg{ opacity: .65; }
    .search-wrap input{
      width: 100%;
      border: none;
      outline: none;
      font-size: 14px;
      background: transparent;
      color: var(--text);
      font-weight: 600;
    }
    .search-wrap input::placeholder{
      color: #9ca3af;
      font-weight: 600;
    }

    /* Categories */
    .category{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-sm);
      padding: 14px;
      margin-bottom: 16px;
      overflow: hidden;
    }

    .cat-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 8px 6px 12px;
    }

    .cat-header-left{
      display:flex;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .cat-header-left .emoji{
      font-size: 18px;
      width: 30px;
      height: 30px;
      display:grid;
      place-items:center;
      border-radius: 10px;
      background: #f3f4f6;
      border: 1px solid var(--border);
    }
    .cat-header-left .name{
      font-weight: 800;
      letter-spacing: -0.4px;
      font-size: 15px;
    }
    .cat-header-left .count{
      font-size: 12px;
      color: var(--muted);
      font-weight: 800;
      background: #f3f4f6;
      border: 1px solid var(--border);
      padding: 3px 8px;
      border-radius: 999px;
    }

    .cat-header-right{
      display:flex;
      align-items:center;
      gap: 8px;
    }

    .btn-add, .btn-del-cat, .btn-add-cat, .btn-primary, .btn-secondary, .btn-cancel{
      border: 1px solid var(--border);
      background: #fff;
      color: var(--text);
      font-weight: 800;
      font-size: 12px;
      padding: 8px 10px;
      border-radius: 12px;
      cursor: pointer;
      display:inline-flex;
      align-items:center;
      gap: 8px;
      transition: transform .08s ease, box-shadow .15s ease, border-color .15s ease, background .15s ease;
      user-select:none;
    }

    .btn-add:hover, .btn-add-cat:hover, .btn-secondary:hover{
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0,0,0,0.06);
      border-color: rgba(139,197,63,0.45);
    }

    .btn-del-cat{
      padding: 8px 9px;
    }
    .btn-del-cat:hover{
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0,0,0,0.06);
      border-color: rgba(239,68,68,0.45);
    }

    .btn-primary{
      background: var(--green);
      border-color: rgba(0,0,0,0.05);
      color: #0b1a08;
      box-shadow: 0 10px 18px rgba(139,197,63,0.25);
    }
    .btn-primary:hover{
      transform: translateY(-1px);
      box-shadow: 0 14px 24px rgba(139,197,63,0.28);
      background: #93cf40;
    }

    .btn-cancel{
      padding: 8px 10px;
    }
    .btn-cancel:hover{
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0,0,0,0.06);
      border-color: rgba(107,114,128,0.4);
      background: #f9fafb;
    }

    /* Cards grid */
    .cards-grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 12px;
      padding: 6px;
    }
    @media (max-width: 980px){ .cards-grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); } }
    @media (max-width: 620px){ .cards-grid{ grid-template-columns: 1fr; } }

    .app-card{
      position: relative;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: #fff;
      box-shadow: 0 10px 22px rgba(0,0,0,0.04);
      overflow:hidden;
      cursor: pointer;
      transition: transform .10s ease, box-shadow .15s ease, border-color .15s ease;
      min-height: 120px;
    }
    .app-card:hover{
      transform: translateY(-2px);
      box-shadow: 0 16px 30px rgba(0,0,0,0.07);
      border-color: rgba(139,197,63,0.35);
    }

    .app-card::before{
      content:"";
      position:absolute;
      inset:0 0 auto 0;
      height: 5px;
      background: var(--card-color, var(--green));
    }

    .card-actions{
      position:absolute;
      top: 10px;
      right: 10px;
      display:flex;
      gap: 8px;
      opacity: 0;
      transform: translateY(-4px);
      transition: opacity .15s ease, transform .15s ease;
      pointer-events:none;
    }
    .app-card:hover .card-actions{
      opacity: 1;
      transform: translateY(0);
      pointer-events:auto;
    }

    .btn-edit, .btn-del{
      width: 32px;
      height: 32px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background:#fff;
      display:grid;
      place-items:center;
      cursor:pointer;
      transition: transform .08s ease, box-shadow .15s ease, border-color .15s ease;
    }
    .btn-edit:hover{
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0,0,0,0.07);
      border-color: rgba(59,130,246,0.35);
    }
    .btn-del:hover{
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0,0,0,0.07);
      border-color: rgba(239,68,68,0.35);
    }

    .card-body{
      display:flex;
      align-items:center;
      gap: 12px;
      padding: 18px 14px 10px;
    }

    .card-icon{
      width: 44px;
      height: 44px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      font-weight: 900;
      color: #0b1a08;
      letter-spacing: -0.5px;
    }

    .card-text{
      flex: 1;
      min-width: 0;
    }
    .app-name{
      font-weight: 900;
      letter-spacing: -0.4px;
      font-size: 14px;
      margin-bottom: 3px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .app-desc{
      color: var(--muted);
      font-size: 12px;
      font-weight: 700;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .card-ext{
      opacity: .6;
      margin-left: auto;
    }

    .card-url{
      padding: 0 14px 14px;
      font-size: 11px;
      color: #9ca3af;
      font-weight: 800;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      border-top: 1px solid #f3f4f6;
      padding-top: 10px;
    }

    /* Add/Edit inline forms */
    .form-panel{
      margin: 10px 6px 2px;
      padding: 12px;
      border-radius: 16px;
      border: 1px dashed rgba(139,197,63,0.45);
      background: linear-gradient(135deg, rgba(139,197,63,0.12), rgba(255,255,255,0.65));
    }

    .form-row{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items:flex-end;
    }

    .form-group{
      display:flex;
      flex-direction:column;
      gap: 6px;
      flex: 1;
      min-width: 160px;
    }
    .form-group label{
      font-size: 11px;
      font-weight: 900;
      color: #4b5563;
      letter-spacing: .2px;
    }
    .form-group input{
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 13px;
      font-weight: 700;
      outline: none;
      background:#fff;
    }
    .form-group input:focus{
      box-shadow: var(--focus);
      border-color: rgba(139,197,63,0.55);
    }

    .color-row{
      display:flex;
      gap: 6px;
      align-items:center;
      padding: 6px 8px;
      border-radius: 12px;
      background:#fff;
      border: 1px solid var(--border);
      height: 40px;
    }
    .color-dot{
      width: 16px;
      height: 16px;
      border-radius: 999px;
      cursor:pointer;
      border: 2px solid rgba(255,255,255,0.7);
      outline: 1px solid rgba(0,0,0,0.08);
      transition: transform .08s ease, outline-color .15s ease;
    }
    .color-dot:hover{ transform: scale(1.08); }
    .color-dot.active{
      outline-color: rgba(0,0,0,0.35);
      transform: scale(1.1);
    }

    .app-card.editing{
      cursor: default;
      padding: 14px;
    }
    .app-card.editing:hover{
      transform:none;
      box-shadow: 0 10px 22px rgba(0,0,0,0.04);
      border-color: var(--border);
    }

    .edit-actions{
      display:flex;
      align-items:center;
      gap: 10px;
      justify-content:flex-end;
    }

    /* Add category area */
    #addCategoryArea{
      margin-top: 14px;
      display:flex;
      justify-content:center;
    }
    .btn-add-cat{
      padding: 10px 14px;
      border-radius: 14px;
    }

    .cat-form{
      display:flex;
      gap: 10px;
      align-items:center;
      padding: 12px;
      border-radius: 16px;
      border: 1px dashed rgba(139,197,63,0.45);
      background: #fff;
      box-shadow: var(--shadow-sm);
      width: min(720px, 100%);
    }
    .cat-form input{
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 13px;
      font-weight: 800;
      outline:none;
      background:#fff;
    }
    .cat-form input:focus{
      box-shadow: var(--focus);
      border-color: rgba(139,197,63,0.55);
    }
    .emoji-input{
      width: 70px;
      text-align:center;
      font-size: 18px;
      font-weight: 900;
    }
    .name-input{
      flex: 1;
      min-width: 160px;
    }

    /* Footer */
    .footer{
      margin-top: 18px;
      text-align:center;
      color: var(--muted);
      font-weight: 700;
      font-size: 12px;
      opacity: .9;
    }

    /* Modal */
    .modal-overlay{
      position: fixed;
      inset: 0;
      background: rgba(17,24,39,0.55);
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 100;
    }
    .hidden{ display:none !important; }

    .modal{
      width: min(860px, 100%);
      background: #fff;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.18);
      box-shadow: 0 30px 70px rgba(0,0,0,0.25);
      padding: 16px;
    }
    .modal h2{
      font-size: 18px;
      letter-spacing: -0.4px;
      margin-bottom: 6px;
    }
    .modal p{
      color: var(--muted);
      font-size: 13px;
      font-weight: 650;
      margin-bottom: 10px;
      line-height: 1.35;
    }
    .modal textarea{
      width: 100%;
      min-height: 280px;
      resize: vertical;
      padding: 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 12px;
      outline: none;
      background: #f9fafb;
    }
    .modal textarea:focus{ box-shadow: var(--focus); border-color: rgba(139,197,63,0.55); }

    .modal-actions{
      display:flex;
      justify-content:flex-end;
      gap: 10px;
      margin-top: 12px;
      flex-wrap: wrap;
    }
  </style>
</head>

<body>

  <div class="top-bar">
    <div class="logo-area">
      <!-- PASTE YOUR BASE64 LOGO HERE (src="data:image/png;base64,....") -->
      <img
        src=""
        alt="British Sugar"
      />
      <div class="logo-text">
        <span class="main">Workspace Hub</span>
        <span class="sub">British Sugar</span>
      </div>
    </div>

    <button class="export-btn" id="exportBtn" type="button" title="Export your saved data">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
      Export Data
    </button>
  </div>

  <!-- Export Modal -->
  <div id="exportModal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="exportTitle">
    <div class="modal">
      <h2 id="exportTitle">Export Your Data</h2>
      <p>Copy this JSON and save it somewhere safe. You can use it to restore your workspace or share it with others.</p>
      <textarea id="exportTextarea" readonly></textarea>
      <div class="modal-actions">
        <button class="btn-secondary" id="closeModal" type="button">Close</button>
        <button class="btn-primary" id="copyBtn" type="button">Copy to Clipboard</button>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="page-header">
      <h1>Your Apps</h1>
      <p>Quick access to all your essential tools</p>
    </div>

    <div class="search-wrap">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <circle cx="11" cy="11" r="8"></circle>
        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
      <input type="text" id="searchInput" placeholder="Search your apps..." autocomplete="off" />
    </div>

    <div id="categoriesContainer"></div>
    <div id="addCategoryArea"></div>

    <div class="footer">Hover over a card to edit or remove ¬∑ Everything saves automatically</div>
  </div>

  <script>
    // ‚îÄ‚îÄ‚îÄ SVG helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const SVG = {
      plus: `<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>`,
      x: `<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>`,
      pencil: `<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>`,
      trash: `<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/></svg>`,
      ext: `<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>`,
      check: `<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>`,
      folder: `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/><line x1="12" y1="11" x2="12" y2="17"/><line x1="9" y1="14" x2="15" y2="14"/></svg>`,
    };

    // ‚îÄ‚îÄ‚îÄ Data & state ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const COLORS = ["#8BC53F","#7AB82E","#6AA61D","#5C941A","#4B7E15","#3B6E11","#F59E0B","#EF4444","#3B82F6","#8B5CF6"];
    const STORAGE_KEY = "workspace-hub-data";

    const DEFAULT_DATA = [
      { id:"hr", name:"HR & People", emoji:"üë•", apps:[
        { id:1, name:"SuccessFactors", desc:"People Hub", url:"https://performancemanager.successfactors.eu/sf/home?bplte_company=britishsugar&_s.crb=95xciufTHZwCzHYjKQSirdsvsM2zilknPWUDmjEX3Yo%3d", color:"#8BC53F" },
        { id:2, name:"Dimensions", desc:"Holiday Booking", url:"https://britishsugar-sso.prd.mykronos.com/wfd/home", color:"#7AB82E" },
        { id:1770152691218, name:"SAP Concur", desc:"Claim Expenses", url:"https://eu2.concursolutions.com/nui/signin?targetURL=%2Fhome", color:"#F59E0B" },
      ]},
      { id:"analytics", name:"Analytics & Data", emoji:"üìä", apps:[
        { id:3, name:"Seeq", desc:"Trends & Analytics", url:"https://britishsugar.seeq.tech/", color:"#6AA61D" },
        { id:1770152509945, name:"Lost Opp", desc:"Lost Opportunity Booking", url:"https://lop-prod.britishsugar.com/Operator", color:"#3B82F6" },
        { id:1770152601565, name:"FTR", desc:"Lab Results", url:"https://ftr-app.azurewebsites.net/login", color:"#8BC53F" },
        { id:1770152828271, name:"QF/Chemical app", desc:"Add QF/LED and chemicals data", url:"https://script.google.com/macros/s/AKfycbwLLQJntWsBaEiA7FMa-u2AplGdxW7tNjAXIV0cwByz0EKDIlVnyS9Qate2ip_dIMVS/exec", color:"#5C941A" },
      ]},
      { id:"general", name:"General", emoji:"üìå", apps:[
        { id:1770153056606, name:"HxGN", desc:"Create Work Orders", url:"https://eu1.eam.hxgnsmartcloud.com/web/base/logindisp?tenant=BRITISHSUGAR_PRD", color:"#EF4444" },
        { id:1770153139586, name:"SIC", desc:"Short Interval Control", url:"https://abfoods.sharepoint.com/sites/bsu-cantleyteamssite/Lists/Cantley%20Performance%20Actions/Short%20Interval%20Control.aspx?viewid=227be9ec-2f19-4264-847d-27472793f812&env=WebViewList&OR=Teams-HL&CT=1733960021665&clickparams=eyJBcHBOYW1lIjoiVGVhbXMtRGVza3RvcCIsIkFwcFZlcnNpb24iOiI0OS8yNDExMDExNTcyMiIsIkhhc0ZlZGVyYXRlZFVzZXIiOmZhbHNlfQ%3D%3D", color:"#F59E0B" },
        { id:1770153195640, name:"British Sugar Intranet", desc:"", url:"https://abfoods.sharepoint.com/sites/bsu-hub", color:"#7AB82E" },
        { id:1770153282586, name:"Change Log", desc:"Plant change log", url:"https://teams.microsoft.com/l/entity/26bc2873-6023-480c-a11b-76b66605ce8c/_djb2_msteams_prefix_2011203644?context=%7B%22channelId%22%3A%2219%3AyIxeEUzWyRK1PMTDiin__Or4MWFuK6Dhq2vAmFYv8741%40thread.tacv2%22%7D&tenantId=39c5be5d-2510-4eee-9ca0-197a6e89e482", color:"#6AA61D" },
        { id:1770153316288, name:"Shift Logs", desc:"", url:"https://teams.microsoft.com/l/entity/com.microsoft.teamspace.tab.planner/_djb2_msteams_prefix_898003600?context=%7B%22channelId%22%3A%2219%3AyIxeEUzWyRK1PMTDiin__Or4MWFuK6Dhq2vAmFYv8741%40thread.tacv2%22%7D&tenantId=39c5be5d-2510-4eee-9ca0-197a6e89e482", color:"#8BC53F" },
        { id:1770153412955, name:"Alcumus", desc:"Incident Reporting", url:"https://britishsugar.info-exchange.com/app/incidents/home", color:"#8B5CF6" },
        { id:1770153448285, name:"Ideas App", desc:"", url:"https://teams.microsoft.com/l/entity/a6b63365-31a4-4f43-92ec-710b71557af9/_djb2_msteams_prefix_2569765742?context=%7B%22chatId%22%3A%2219%3A9f7c1791d44744eca1ec1c5b572a1d9f%40thread.v2%22%2C%22contextType%22%3A%22chat%22%7D&tenantId=39c5be5d-2510-4eee-9ca0-197a6e89e482", color:"#5C941A" },
        { id:1770153572299, name:"Ops Chat", desc:"Operational Communications Chat", url:"https://teams.microsoft.com/l/chat/19:9f7c1791d44744eca1ec1c5b572a1d9f@thread.v2/conversations?context=%7B%22contextType%22%3A%22chat%22%7D", color:"#7AB82E" },
      ]},
    ];

    let categories = loadData();
    let addingTo = null;
    let editingApp = null;
    let addingCat = false;

    let formState = { name:"", desc:"", url:"", color: COLORS[0] };
    let newCatState = { name:"", emoji:"üìÅ" };

    function loadData() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        return raw ? JSON.parse(raw) : structuredClone(DEFAULT_DATA);
      } catch {
        return structuredClone(DEFAULT_DATA);
      }
    }
    function saveData() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(categories, null, 2));
    }

    // ‚îÄ‚îÄ‚îÄ Export modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const exportBtn = document.getElementById("exportBtn");
    const exportModal = document.getElementById("exportModal");
    const exportTextarea = document.getElementById("exportTextarea");
    const closeModal = document.getElementById("closeModal");
    const copyBtn = document.getElementById("copyBtn");

    exportBtn.addEventListener("click", () => {
      const data = localStorage.getItem(STORAGE_KEY) || JSON.stringify(categories, null, 2);
      exportTextarea.value = data;
      exportModal.classList.remove("hidden");
      exportTextarea.focus();
      exportTextarea.select();
    });

    closeModal.addEventListener("click", () => {
      exportModal.classList.add("hidden");
    });

    copyBtn.addEventListener("click", async () => {
      const data = exportTextarea.value;
      try {
        await navigator.clipboard.writeText(data);
      } catch {
        exportTextarea.select();
        document.execCommand("copy");
      }
      const original = copyBtn.textContent;
      copyBtn.textContent = "‚úì Copied!";
      setTimeout(() => copyBtn.textContent = original, 1600);
    });

    exportModal.addEventListener("click", (e) => {
      if (e.target === exportModal) exportModal.classList.add("hidden");
    });
    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape") exportModal.classList.add("hidden");
    });

    // ‚îÄ‚îÄ‚îÄ Render ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const categoriesContainer = document.getElementById("categoriesContainer");
    const addCategoryArea = document.getElementById("addCategoryArea");
    const searchInput = document.getElementById("searchInput");

    function render() {
      const search = searchInput.value.trim().toLowerCase();

      const filtered = categories
        .map(cat => ({
          ...cat,
          apps: cat.apps.filter(a =>
            (a.name || "").toLowerCase().includes(search) ||
            (a.desc || "").toLowerCase().includes(search)
          )
        }))
        .filter(cat => cat.apps.length > 0 || !search);

      categoriesContainer.innerHTML = filtered.map(renderCategory).join("");
      renderAddCategoryArea();

      // Attach events
      document.querySelectorAll(".btn-add[data-cat]").forEach(btn => {
        btn.addEventListener("click", () => {
          addingTo = (addingTo === btn.dataset.cat) ? null : btn.dataset.cat;
          editingApp = null;
          render();
        });
      });

      document.querySelectorAll(".btn-del-cat[data-cat]").forEach(btn => {
        btn.addEventListener("click", () => {
          const id = btn.dataset.cat;
          categories = categories.filter(c => c.id !== id);
          saveData();
          render();
        });
      });

      document.querySelectorAll(".app-card[data-cat][data-app]").forEach(card => {
        card.addEventListener("click", (e) => {
          if (e.target.closest(".btn-edit, .btn-del, .card-actions")) return;
          const app = getApp(card.dataset.cat, card.dataset.app);
          if (app?.url) window.open(app.url, "_blank", "noopener,noreferrer");
        });
      });

      document.querySelectorAll(".btn-edit[data-cat][data-app]").forEach(btn => {
        btn.addEventListener("click", (e) => {
          e.stopPropagation();
          const app = getApp(btn.dataset.cat, btn.dataset.app);
          if (!app) return;
          editingApp = { catId: btn.dataset.cat, app: { ...app } };
          addingTo = null;
          render();
        });
      });

      document.querySelectorAll(".btn-del[data-cat][data-app]").forEach(btn => {
        btn.addEventListener("click", (e) => {
          e.stopPropagation();
          removeApp(btn.dataset.cat, btn.dataset.app);
        });
      });

      // Add form wiring
      const addForm = document.getElementById("addForm");
      if (addForm) {
        addForm.querySelector("#formName").addEventListener("input", e => formState.name = e.target.value);
        addForm.querySelector("#formDesc").addEventListener("input", e => formState.desc = e.target.value);
        addForm.querySelector("#formUrl").addEventListener("input", e => formState.url = e.target.value);
        addForm.querySelector("#formUrl").addEventListener("keydown", e => { if (e.key === "Enter") submitAdd(); });

        addForm.querySelectorAll(".color-dot").forEach(dot => {
          dot.addEventListener("click", () => {
            formState.color = dot.dataset.color;
            render();
          });
        });

        addForm.querySelector("#btnSubmitAdd").addEventListener("click", submitAdd);
        addForm.querySelector("#btnCancelAdd").addEventListener("click", () => {
          addingTo = null;
          formState = { name:"", desc:"", url:"", color: COLORS[0] };
          render();
        });
      }

      // Edit form wiring
      const editForm = document.getElementById("editForm");
      if (editForm && editingApp) {
        editForm.querySelector("#editName").addEventListener("input", e => editingApp.app.name = e.target.value);
        editForm.querySelector("#editDesc").addEventListener("input", e => editingApp.app.desc = e.target.value);
        editForm.querySelector("#editUrl").addEventListener("input", e => editingApp.app.url = e.target.value);

        editForm.querySelectorAll(".color-dot").forEach(dot => {
          dot.addEventListener("click", () => {
            editingApp.app.color = dot.dataset.color;
            render();
          });
        });

        editForm.querySelector("#btnSaveEdit").addEventListener("click", submitEdit);
        editForm.querySelector("#btnCancelEdit").addEventListener("click", () => {
          editingApp = null;
          render();
        });
      }

      // Category create wiring
      const catFormEl = document.getElementById("catForm");
      if (catFormEl) {
        catFormEl.querySelector("#catEmoji").addEventListener("input", e => newCatState.emoji = e.target.value);
        catFormEl.querySelector("#catName").addEventListener("input", e => newCatState.name = e.target.value);
        catFormEl.querySelector("#catName").addEventListener("keydown", e => { if (e.key === "Enter") submitAddCat(); });
        catFormEl.querySelector("#btnCreateCat").addEventListener("click", submitAddCat);
        catFormEl.querySelector("#btnCancelCat").addEventListener("click", () => {
          addingCat = false;
          newCatState = { name:"", emoji:"üìÅ" };
          render();
        });
      }

      const addCatBtn = document.getElementById("btnAddCat");
      if (addCatBtn) {
        addCatBtn.addEventListener("click", () => {
          addingCat = true;
          render();
        });
      }
    }

    function renderCategory(cat) {
      const isAdding = addingTo === cat.id;
      const showDel = cat.apps.length === 0;

      return `
        <div class="category">
          <div class="cat-header">
            <div class="cat-header-left">
              <span class="emoji">${escHtml(cat.emoji || "üìÅ")}</span>
              <span class="name">${escHtml(cat.name)}</span>
              <span class="count">${cat.apps.length}</span>
            </div>
            <div class="cat-header-right">
              <button class="btn-add" data-cat="${cat.id}" type="button">${SVG.plus} Add</button>
              ${showDel ? `<button class="btn-del-cat" data-cat="${cat.id}" type="button" title="Delete empty category">${SVG.trash}</button>` : ""}
            </div>
          </div>

          ${isAdding ? renderAddForm(cat.id) : ""}

          <div class="cards-grid">
            ${cat.apps.map(app => renderCard(cat.id, app)).join("")}
          </div>
        </div>
      `;
    }

    function renderCard(catId, app) {
      if (editingApp && editingApp.catId === catId && String(editingApp.app.id) === String(app.id)) {
        return renderEditCard();
      }

      const color = app.color || COLORS[0];
      const initial = (app.name || "?").trim().charAt(0).toUpperCase() || "?";
      const urlDisplay = (app.url || "").replace(/^https?:\/\//,"");

      return `
        <div class="app-card" data-cat="${catId}" data-app="${app.id}" style="--card-color:${escHtml(color)}">
          <div class="card-actions">
            <button class="btn-edit" data-cat="${catId}" data-app="${app.id}" type="button" title="Edit">${SVG.pencil}</button>
            <button class="btn-del" data-cat="${catId}" data-app="${app.id}" type="button" title="Delete">${SVG.trash}</button>
          </div>

          <div class="card-body">
            <div class="card-icon" style="background:linear-gradient(135deg,${escHtml(color)},${escHtml(color)}dd); box-shadow:0 3px 10px ${escHtml(color)}40;">
              ${escHtml(initial)}
            </div>

            <div class="card-text">
              <div class="app-name">${escHtml(app.name || "")}</div>
              ${app.desc ? `<div class="app-desc">${escHtml(app.desc)}</div>` : ""}
            </div>

            <div class="card-ext" aria-hidden="true">${SVG.ext}</div>
          </div>

          <div class="card-url">${escHtml(urlDisplay)}</div>
        </div>
      `;
    }

    function renderEditCard() {
      const a = editingApp.app;
      return `
        <div class="app-card editing" id="editForm">
          <input id="editName" value="${escHtml(a.name || "")}" placeholder="Name" style="width:100%; margin-bottom:8px; padding:10px 12px; border:1px solid var(--border); border-radius:12px; font-weight:800; outline:none;" />
          <input id="editDesc" value="${escHtml(a.desc || "")}" placeholder="Description" style="width:100%; margin-bottom:8px; padding:10px 12px; border:1px solid var(--border); border-radius:12px; font-weight:800; outline:none;" />
          <input id="editUrl" value="${escHtml(a.url || "")}" placeholder="URL" style="width:100%; margin-bottom:10px; padding:10px 12px; border:1px solid var(--border); border-radius:12px; font-weight:800; outline:none;" />

          <div class="color-row" style="margin-bottom:10px;">
            ${COLORS.map(c => `
              <div class="color-dot ${a.color===c ? "active" : ""}" data-color="${c}" style="background:${c}"></div>
            `).join("")}
          </div>

          <div class="edit-actions">
            <button class="btn-primary" id="btnSaveEdit" type="button">${SVG.check} Save</button>
            <button class="btn-cancel" id="btnCancelEdit" type="button" title="Cancel">${SVG.x}</button>
          </div>
        </div>
      `;
    }

    function renderAddForm(catId) {
      return `
        <div class="form-panel" id="addForm">
          <div class="form-row">
            <div class="form-group">
              <label>App Name *</label>
              <input id="formName" value="${escHtml(formState.name)}" placeholder="e.g. Slack" />
            </div>

            <div class="form-group">
              <label>Description</label>
              <input id="formDesc" value="${escHtml(formState.desc)}" placeholder="e.g. Messaging" />
            </div>

            <div class="form-group">
              <label>URL *</label>
              <input id="formUrl" value="${escHtml(formState.url)}" placeholder="e.g. https://example.com" />
            </div>

            <div style="display:flex; gap:10px; align-items:flex-end; flex-wrap:wrap;">
              <div class="color-row">
                ${COLORS.map(c => `
                  <div class="color-dot ${formState.color===c ? "active" : ""}" data-color="${c}" style="background:${c}"></div>
                `).join("")}
              </div>

              <button class="btn-primary" id="btnSubmitAdd" type="button">Add</button>
              <button class="btn-cancel" id="btnCancelAdd" type="button" title="Cancel">${SVG.x}</button>
            </div>
          </div>
        </div>
      `;
    }

    function renderAddCategoryArea() {
      if (addingCat) {
        addCategoryArea.innerHTML = `
          <div class="cat-form" id="catForm">
            <input class="emoji-input" id="catEmoji" value="${escHtml(newCatState.emoji)}" placeholder="üìÅ" />
            <input class="name-input" id="catName" value="${escHtml(newCatState.name)}" placeholder="Category name" />
            <button class="btn-primary" id="btnCreateCat" type="button">Create</button>
            <button class="btn-cancel" id="btnCancelCat" type="button" title="Cancel">${SVG.x}</button>
          </div>
        `;
      } else {
        addCategoryArea.innerHTML = `<button class="btn-add-cat" id="btnAddCat" type="button">${SVG.folder} Add Category</button>`;
      }
    }

    // ‚îÄ‚îÄ‚îÄ Actions ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function submitAdd() {
      if (!formState.name || !formState.url) return;

      const url = formState.url.startsWith("http") ? formState.url : "https://" + formState.url;
      const cat = categories.find(c => c.id === addingTo);
      if (cat) {
        cat.apps.push({
          id: Date.now(),
          name: formState.name.trim(),
          desc: (formState.desc || "").trim(),
          url,
          color: formState.color
        });
      }

      saveData();
      addingTo = null;
      formState = { name:"", desc:"", url:"", color: COLORS[0] };
      render();
    }

    function submitEdit() {
      if (!editingApp) return;

      const url = editingApp.app.url?.startsWith("http") ? editingApp.app.url : "https://" + (editingApp.app.url || "");
      const cat = categories.find(c => c.id === editingApp.catId);
      if (cat) {
        const idx = cat.apps.findIndex(a => String(a.id) === String(editingApp.app.id));
        if (idx > -1) cat.apps[idx] = { ...editingApp.app, url };
      }

      saveData();
      editingApp = null;
      render();
    }

    function removeApp(catId, appId) {
      const cat = categories.find(c => c.id === catId);
      if (cat) cat.apps = cat.apps.filter(a => String(a.id) !== String(appId));
      saveData();
      render();
    }

    function getApp(catId, appId) {
      const cat = categories.find(c => c.id === catId);
      return cat ? cat.apps.find(a => String(a.id) === String(appId)) : null;
    }

    function escHtml(s) {
      return String(s)
        .replace(/&/g,"&amp;")
        .replace(/</g,"&lt;")
        .replace(/>/g,"&gt;")
        .replace(/"/g,"&quot;");
    }

    searchInput.addEventListener("input", render);
    render();
  </script>
</body>
</html>
